---
title: "HW 1"
author: "Austin Pesina"
date: "2/24/2021"
output:
  pdf_document: default
  html_document: default
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
setwd("~/Intro_to_R/HW_1")

NEI <- read_rds ("summarySCC_PM25.rds")
SCC <- read_rds ("Source_Classification_Code.rds")
```

## Question 1

Emissions have steadily decreased from 1999 to 2008, dropping from $7*10^6$ tons of PM 2.5 Emission in 1999 to under $4*10^6$ tons of PM 2.5 EMissions in 2008.

```{r Question 1}
nei <- aggregate(Emissions ~ year, NEI, sum)

plot(nei$year, nei$Emissions, type = "o", col = "blue",
     main = "Total PM 2.5 Emission From 1999 to 2008", xlab = "Year", ylab = "Emissions")
```

## Question 2

In San Antonio, total PM 2.5 Emissions have dropped from 17,500 tons in 1999 to 7,500 tons in 2008.

```{r Question 2, warning=FALSE}
sa <- subset(NEI, NEI$fips == "48029")

total_sa <- aggregate(Emissions ~ year, sa, sum)

ggplot (total_sa, mapping = aes(year, Emissions)) +
  ggtitle (expression("Total Emissions from PM 2.5 in San Antonio (1999-2008)")) +
          geom_point () +
        geom_smooth()
```

## Question 3

Nonpoint emissions have had the biggest drop in San Antonio. Point emissions dropped between 1999 and 2002, but rose slightly between 2002 and 2008. Non-road emissions had the opposite effect. The rose slightly between 1999 and 2002, but began to drop between 2002 and 2008. On-road emissions had a very slight drop, but mostly stayed the same.

``` {r Question 3}
type_sa <- aggregate(Emissions ~ year + type, sa, sum)

ggplot (type_sa, mapping = aes (year, Emissions, col = type)) + 
  ggtitle (expression("Emissions by Type in San Antonio (1999-2008)")) +
  geom_point () + 
  geom_line()
```


## Question 4

Only Point and Nonpoint emissions were coal combustion-related.Point emissions had a major drop, while Nonpoint emissions rose betwee 1999 and 2002 before beginning to drop in 2005.

``` {r Question 4}
scc_coal <- SCC[grepl("coal", SCC$Short.Name, ignore.case = T),]
nei_coal <- NEI[NEI$SCC %in% scc_coal$SCC,]
coal_tot <- aggregate(Emissions ~ year + type, nei_coal, sum)

ggplot (coal_tot, aes(year, Emissions, col = type)) +
  ggtitle (expression("Emissions from Coal Combustion-Related Sources")) +
  geom_point() +
  geom_line()
```

## Question 5

Between 1999 and 2005, Motor Vehicle Emissions dropped almost linearly. Between 2005 and 2008, Motor Vehicle Emissions began to see a much steeper drop, ending at slightly abov 400 tons in 2008.

``` {r Question 5}
cars <- filter(NEI, NEI$fips =="48029" & NEI$type == "ON-ROAD")
mv_sa <- aggregate(Emissions ~ year, cars, sum)

ggplot (mv_sa, mapping = aes (year, Emissions)) + 
  ggtitle (expression("Motor Vehicle Emissions in San Antonio (1999-2008)")) +
  geom_point () + 
  geom_line(col = "blue")
```


## Question 6

Los Angeles had an increase in Motor Vehicle Emissions between 1999 and 2005. After 2005, their emissions finally began to drop, ending slightly above 4,000 tons in 2008. San Antonio had much lower emissions by comparison.

``` {r Question 6}
sa_la <- filter(NEI, NEI$fips %in% c("06037", "48209") & NEI$type == "ON-ROAD")
mv_sa_la <- aggregate (Emissions ~ year + fips, sa_la, sum)

ggplot (mv_sa_la, mapping = aes (year, Emissions, col = fips)) + 
  ggtitle (expression("Motor Vehicle Emissions: Los Angeles vs San Antonio (1999-2008)")) +
  geom_point () + 
  geom_line() +
  scale_color_discrete(name = "City", labels = c("Los Angeles", "San Antonio"))
```